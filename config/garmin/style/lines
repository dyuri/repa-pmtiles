# -------------------------------------------------------------------
# Hungarian Hiking Map - Line Features
# Based on process-hiking.lua trail extraction logic
# -------------------------------------------------------------------

# Hiking routes from relations (processed in relations file)
# These get converted to ways with special attributes

# TRAILS - Main hiking features with route colors
# Match the Lua config: highway=path|footway|cycleway|bridleway|track|steps
# Trail colors from route relations (applied by relations file)

# DEBUG: Check if ANY hiking routes are detected (should render as 0x29 if relations work)
(highway=path | highway=footway | highway=track) & hiking_route=yes [0x29 resolution 22 continue]

# Colored hiking trails - check for individual color flags set by relations file
# Each color gets its own Garmin type code for different visual appearance
# Using continue so a way can be drawn multiple times if it's part of multiple routes
# Type codes 0x2a-0x31 chosen to avoid conflicts with roads/tracks

(highway=path | highway=footway | highway=track) & hiking_red=yes [0x2a resolution 22 continue]
(highway=path | highway=footway | highway=track) & hiking_blue=yes [0x2b resolution 22 continue]
(highway=path | highway=footway | highway=track) & hiking_yellow=yes [0x2c resolution 22 continue]
(highway=path | highway=footway | highway=track) & hiking_green=yes [0x2d resolution 22 continue]
(highway=path | highway=footway | highway=track) & hiking_orange=yes [0x2e resolution 22 continue]
(highway=path | highway=footway | highway=track) & hiking_purple=yes [0x2f resolution 22 continue]
(highway=path | highway=footway | highway=track) & hiking_white=yes [0x30 resolution 22 continue]
(highway=path | highway=footway | highway=track) & hiking_black=yes [0x31 resolution 22 continue]

# Add route names as labels - mkgmap:route_name may contain multiple names (semicolon-separated)
(highway=path | highway=footway | highway=track) & mkgmap:route_name=* {
    name '${mkgmap:route_name}' | '${mkgmap:route_ref}' | '${name}'
}

# Paths with SAC scale difficulty
highway=path & sac_scale=demanding_alpine_hiking [0x16 resolution 24]
highway=path & sac_scale=alpine_hiking [0x16 resolution 24]
highway=path & sac_scale=demanding_mountain_hiking [0x16 resolution 24]
highway=path & sac_scale=mountain_hiking [0x16 resolution 24]
highway=path & sac_scale=hiking [0x16 resolution 24]

# Generic paths and footways (fallback for unmarked trails)
# NO CONTINUE - these should only match if no colored trail rule matched
highway=path [0x16 resolution 24]
highway=footway [0x16 resolution 24]
highway=steps [0x16 resolution 24]

# Bridleway and cycleway
highway=bridleway [0x16 resolution 24]
highway=cycleway [0x16 resolution 24]

# Tracks by grade (matching Lua MinZoom(11))
highway=track & tracktype=grade1 [0x0e resolution 22]
highway=track & tracktype=grade2 [0x0f resolution 22]
highway=track & tracktype=grade3 [0x10 resolution 22]
highway=track & tracktype=grade4 [0x10 resolution 23]
highway=track & tracktype=grade5 [0x10 resolution 23]
highway=track [0x0a resolution 22]

# ROADS - For context (matching Lua zoom levels)
# Major roads from zoom 8
highway=motorway [0x01 resolution 16 continue]
highway=motorway_link [0x01 resolution 18]
highway=trunk [0x02 resolution 16 continue]
highway=trunk_link [0x02 resolution 18]

# Primary roads from zoom 9
highway=primary [0x03 resolution 18 continue]
highway=primary_link [0x03 resolution 20]

# Secondary/tertiary from zoom 10
highway=secondary [0x04 resolution 20 continue]
highway=secondary_link [0x04 resolution 20]
highway=tertiary [0x05 resolution 20 continue]
highway=tertiary_link [0x05 resolution 20]

# Smaller roads from zoom 11 (matching Lua MinZoom(11))
highway=unclassified [0x06 resolution 22]
highway=residential [0x06 resolution 22]
highway=service [0x07 resolution 23]
highway=living_street [0x06 resolution 22]
highway=road [0x06 resolution 22]
highway=minor [0x06 resolution 22]

# WATERWAYS - Matching Lua config
waterway=river [0x1f resolution 18 continue]
waterway=stream [0x18 resolution 22 continue]
waterway=canal [0x1f resolution 21 continue]
waterway=drain [0x18 resolution 23]
waterway=ditch [0x18 resolution 24]

# BOUNDARIES - Administrative boundaries (matching Lua)
boundary=administrative & admin_level=2 [0x1e resolution 12]
boundary=administrative & admin_level=4 [0x1d resolution 16]
boundary=administrative & admin_level=6 [0x1c resolution 18]
boundary=administrative & admin_level=8 [0x1c resolution 20]

# Add name labels where available
(highway=path | highway=footway | highway=track) & name=* {
    name '${name}' | '${ref}'
}

highway=* & ref=* {
    name '${ref}'
}

waterway=* & name=* {
    name '${name}'
}
